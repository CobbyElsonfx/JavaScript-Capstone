<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <form class="reservation-form">
    <div class="form-group ">
        <input type="text" class="form-control" id="exampleInputName" aria-describedby="nameHelp" placeholder="Enter name" name = "username">
        
    </div>
    <div class="form-group">
      <label for="startDate">Start Date</label>
      <input type="text" class="form-control datepicker" id="startDate" placeholder="Select start date" name="date_start">
      <small id="emailHelp" class="form-text text-muted">Note : The format should be like this only "YEAR-MONTH-DAY" </small>
    </div>
    <div class="form-group">
      <label for="endDate">End Date</label>
      <input type="text" class="form-control datepicker" id="endDate" placeholder="Select end date" name="date_end">
      <small id="emailHelp" class="form-text text-muted">Note : The format should be like this only "YEAR-MONTH-DAY" </small>
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
    <button id="get-reservations">click</button>
</form>
</body>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const form = document.querySelector(".reservation-form");

    form.addEventListener("submit", async function(event) {
        event.preventDefault();

        const username = form.querySelector("[name='username']").value;
        const dateStart = form.querySelector("[name='date_start']").value;
        const dateEnd = form.querySelector("[name='date_end']").value;

        const requestBody = {
            item_id: "item1", // Replace with the actual item ID
            username: username,
            date_start: dateStart,
            date_end: dateEnd
        };

        const url = "https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/XySHXEsIGGBSA40iaBEF/reservations/";

        try {
            const response = await fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(requestBody)
            });

            if (response.status === 201) {
                // Successful reservation
                console.log("Reservation successful!");
            } else {
                console.error("Reservation failed:", response.status);
            }
        } catch (error) {
            console.error("Error:", error);
        }
    });

     // Assuming you have a button or trigger for the GET action
     const getButton = document.getElementById("get-reservations");
    console.log(getButton);
   getButton.addEventListener("click", async function() {
    const item_id = "item1"; // Replace with the actual item ID
    const app_id = "XySHXEsIGGBSA40iaBEF"; // Replace with the actual app ID
    const getUrl = `https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/${app_id}/reservations?item_id=${item_id}`;

    try {
        const response = await fetch(getUrl);

        if (response.ok) {
            const reservations = await response.json();
            console.log("Reservations:", reservations);
            console.log("Reservations:", reservations.length);
            // Process and display reservations as needed
        } else {
            console.error("Failed to retrieve reservations:", response.status);
        }
    } catch (error) {
        console.error("Error:", error);
    }
});
});
const getData = () =>{
  document.addEventListener("DOMContentLoaded", function() {
    // Your form submission code here

   
});

}
</script>
</html>